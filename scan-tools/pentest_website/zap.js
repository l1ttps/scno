var axios = require('axios')

var zap_port = '8090';
var zap = 'http://localhost:' + zap_port;

exports.CheckRunning = function() {
    return new Promise(function(resolve, reject) {
        axios.get(zap).then(function(response, err) {
                resolve(response)
            })
            .catch(function(error) {
                resolve(error)
            });
    })
}

exports.spider = function(url) {
    return new Promise(function(resolve, reject) {
        axios.get(zap + '/JSON/spider/action/scan', {
                params: {
                    url: url
                }
            }).then(function(response, err) {
                resolve(response)
            })
            .catch(function(error) {
                resolve(error)
            });
    })
}

exports.SpiderStatus = function(id) {
    return new Promise(function(resolve, reject) {
        axios.get(zap + '/JSON/spider/view/status', {
                params: {
                    scanId: id
                }
            }).then(function(response, err) {
                resolve(response)
            })
            .catch(function(error) {
                resolve(error)
            });
    })
}
exports.SpiderResuit = function(id) {
    return new Promise(function(resolve, reject) {
        axios.get(zap + '/JSON/spider/view/results', {
                params: {
                    scanId: id
                }
            }).then(function(response, err) {
                resolve(response)
            })
            .catch(function(error) {
                resolve(error)
            });
    })
}
exports.Ascan = function(target) {
    return new Promise(function(resolve, reject) {
        axios.get(zap + '/JSON/ascan/action/scan', {
                params: {
                    url: target
                }
            }).then(function(response, err) {
                resolve(response)
            })
            .catch(function(error) {
                resolve(error)
            });
    })
}

exports.AscanStatus = function(id) {
    return new Promise(function(resolve, reject) {
        axios.get(zap + '/JSON/ascan/view/status', {
                params: {
                    scanId: id
                }
            }).then(function(response, err) {

                resolve(response)
            })
            .catch(function(error) {
                resolve(error)
            });
    })
}